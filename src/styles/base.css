@import "tailwindcss";

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(4px); }
  to { opacity: 1; transform: translateY(0); }
}

html {
  scroll-behavior: smooth;
  scroll-padding-top: 2rem;
}

@theme {
  --font-system: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont,
    "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif,
    "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  
  /* Colors */
  --color-his-green: oklch(0.88 0.12 142.49);
  --color-his-bg: var(--color-flexoki-dark-bg);
  --color-his-text: var(--color-flexoki-paper);
  --color-his-text-secondary: var(--color-flexoki-base-200);
  --color-his-text-tertiary: var(--color-flexoki-base-400);
  --color-his-hr: var(--color-flexoki-dark-ui-2);
  --color-his-chat-default: var(--color-flexoki-dark-tx-3);
  --color-his-chat-sent: var(--color-flexoki-dark-bg-2);
  --color-his-chat-other: var(--color-flexoki-dark-bg-2);
  --color-his-hover: var(--color-flexoki-dark-ui-2);
  --color-his-active: var(--color-flexoki-base-800); /* Darker active state for dark mode */
  --color-his-chat-bg: var(--color-flexoki-dark-ui-2);
}

@theme {
  --color-flexoki-black:       #100F0F;
  --color-flexoki-paper:       #FFFCF0;
  --color-flexoki-base-50:     #F2F0E5;
  --color-flexoki-base-100:    #E6E4D9;
  --color-flexoki-base-150:    #DAD8CE;
  --color-flexoki-base-200:    #CECDC3;
  --color-flexoki-base-300:    #B7B5AC;
  --color-flexoki-base-400:    #9F9D96;
  --color-flexoki-base-500:    #878580;
  --color-flexoki-base-600:    #6F6E69;
  --color-flexoki-base-700:    #575653;
  --color-flexoki-base-800:    #403E3C;
  --color-flexoki-base-850:    #343331;
  --color-flexoki-base-900:    #282726;
  --color-flexoki-base-950:    #1C1B1A;
  --color-flexoki-red-50:      #FFE1D5;
  --color-flexoki-red-100:     #FFCABB;
  --color-flexoki-red-150:     #FDB2A2;
  --color-flexoki-red-200:     #F89A8A;
  --color-flexoki-red-300:     #E8705F;
  --color-flexoki-red-400:     #D14D41;
  --color-flexoki-red-500:     #C03E35;
  --color-flexoki-red-600:     #AF3029;
  --color-flexoki-red-700:     #942822;
  --color-flexoki-red-800:     #6C201C;
  --color-flexoki-red-850:     #551B18;
  --color-flexoki-red-900:     #3E1715;
  --color-flexoki-red-950:     #261312;
  --color-flexoki-orange-50:   #FFE7CE;
  --color-flexoki-orange-100:  #FED3AF;
  --color-flexoki-orange-150:  #FCC192;
  --color-flexoki-orange-200:  #F9AE77;
  --color-flexoki-orange-300:  #EC8B49;
  --color-flexoki-orange-400:  #DA702C;
  --color-flexoki-orange-500:  #CB6120;
  --color-flexoki-orange-600:  #BC5215;
  --color-flexoki-orange-700:  #9D4310;
  --color-flexoki-orange-800:  #71320D;
  --color-flexoki-orange-850:  #59290D;
  --color-flexoki-orange-900:  #40200D;
  --color-flexoki-orange-950:  #27180E;
  --color-flexoki-yellow-50:   #FAEEC6;
  --color-flexoki-yellow-100:  #F6E2A0;
  --color-flexoki-yellow-150:  #F1D67E;
  --color-flexoki-yellow-200:  #ECCB60;
  --color-flexoki-yellow-300:  #DFB431;
  --color-flexoki-yellow-400:  #D0A215;
  --color-flexoki-yellow-500:  #BE9207;
  --color-flexoki-yellow-600:  #AD8301;
  --color-flexoki-yellow-700:  #8E6B01;
  --color-flexoki-yellow-800:  #664D01;
  --color-flexoki-yellow-850:  #503D02;
  --color-flexoki-yellow-900:  #3A2D04;
  --color-flexoki-yellow-950:  #241E08;
  --color-flexoki-green-50:    #EDEECF;
  --color-flexoki-green-100:   #DDE2B2;
  --color-flexoki-green-150:   #CDD597;
  --color-flexoki-green-200:   #BEC97E;
  --color-flexoki-green-300:   #A0AF54;
  --color-flexoki-green-400:   #879A39;
  --color-flexoki-green-500:   #768D21;
  --color-flexoki-green-600:   #66800B;
  --color-flexoki-green-700:   #536907;
  --color-flexoki-green-800:   #3D4C07;
  --color-flexoki-green-850:   #313D07;
  --color-flexoki-green-900:   #252D09;
  --color-flexoki-green-950:   #1A1E0C;
  --color-flexoki-cyan-50:     #DDF1E4;
  --color-flexoki-cyan-100:    #BFE8D9;
  --color-flexoki-cyan-150:    #A2DECE;
  --color-flexoki-cyan-200:    #87D3C3;
  --color-flexoki-cyan-300:    #5ABDAC;
  --color-flexoki-cyan-400:    #3AA99F;
  --color-flexoki-cyan-500:    #2F968D;
  --color-flexoki-cyan-600:    #24837B;
  --color-flexoki-cyan-700:    #1C6C66;
  --color-flexoki-cyan-800:    #164F4A;
  --color-flexoki-cyan-850:    #143F3C;
  --color-flexoki-cyan-900:    #122F2C;
  --color-flexoki-cyan-950:    #101F1D;
  --color-flexoki-blue-50:     #E1ECEB;
  --color-flexoki-blue-100:    #C6DDE8;
  --color-flexoki-blue-150:    #ABCFE2;
  --color-flexoki-blue-200:    #92BFDB;
  --color-flexoki-blue-300:    #66A0C8;
  --color-flexoki-blue-400:    #4385BE;
  --color-flexoki-blue-500:    #3171B2;
  --color-flexoki-blue-600:    #205EA6;
  --color-flexoki-blue-700:    #1A4F8C;
  --color-flexoki-blue-800:    #163B66;
  --color-flexoki-blue-850:    #133051;
  --color-flexoki-blue-900:    #12253B;
  --color-flexoki-blue-950:    #101A24;
  --color-flexoki-purple-50:   #F0EAEC;
  --color-flexoki-purple-100:  #E2D9E9;
  --color-flexoki-purple-150:  #D3CAE6;
  --color-flexoki-purple-200:  #C4B9E0;
  --color-flexoki-purple-300:  #A699D0;
  --color-flexoki-purple-400:  #8B7EC8;
  --color-flexoki-purple-500:  #735EB5;
  --color-flexoki-purple-600:  #5E409D;
  --color-flexoki-purple-700:  #4F3685;
  --color-flexoki-purple-800:  #3C2A62;
  --color-flexoki-purple-850:  #31234E;
  --color-flexoki-purple-900:  #261C39;
  --color-flexoki-purple-950:  #1A1623;
  --color-flexoki-magenta-50:  #FEE4E5;
  --color-flexoki-magenta-100: #FCCFDA;
  --color-flexoki-magenta-150: #F9B9CF;
  --color-flexoki-magenta-200: #F4A4C2;
  --color-flexoki-magenta-300: #E47DA8;
  --color-flexoki-magenta-400: #CE5D97;
  --color-flexoki-magenta-500: #B74583;
  --color-flexoki-magenta-600: #A02F6F;
  --color-flexoki-magenta-700: #87285E;
  --color-flexoki-magenta-800: #641F46;
  --color-flexoki-magenta-850: #4F1B39;
  --color-flexoki-magenta-900: #39172B;
  --color-flexoki-magenta-950: #24131D;
}

@theme inline {
  --color-flexoki-light-bg:    var(--color-flexoki-paper);
  --color-flexoki-light-bg-2:  var(--color-flexoki-base-50);
  --color-flexoki-light-tx:    var(--color-flexoki-black);
  --color-flexoki-light-tx-2:  var(--color-flexoki-base-600);
  --color-flexoki-light-tx-3:  var(--color-flexoki-base-300);
  --color-flexoki-light-ui:    var(--color-flexoki-base-100);
  --color-flexoki-light-ui-2:  var(--color-flexoki-base-150);
  --color-flexoki-light-ui-3:  var(--color-flexoki-base-200);
  --color-flexoki-dark-bg:     var(--color-flexoki-black);
  --color-flexoki-dark-bg-2:   var(--color-flexoki-base-950);
  --color-flexoki-dark-tx:     var(--color-flexoki-base-200);
  --color-flexoki-dark-tx-2:   var(--color-flexoki-base-500);
  --color-flexoki-dark-tx-3:   var(--color-flexoki-base-700);
  --color-flexoki-dark-ui:     var(--color-flexoki-base-900);
  --color-flexoki-dark-ui-2:   var(--color-flexoki-base-850);
  --color-flexoki-dark-ui-3:   var(--color-flexoki-base-800);
  --color-flexoki-light-re:    var(--color-flexoki-red-600);
  --color-flexoki-light-or:    var(--color-flexoki-orange-600);
  --color-flexoki-light-ye:    var(--color-flexoki-yellow-600);
  --color-flexoki-light-gr:    var(--color-flexoki-green-600);
  --color-flexoki-light-cy:    var(--color-flexoki-cyan-600);
  --color-flexoki-light-bl:    var(--color-flexoki-blue-600);
  --color-flexoki-light-pu:    var(--color-flexoki-purple-600);
  --color-flexoki-light-ma:    var(--color-flexoki-magenta-600);
  --color-flexoki-dark-re:     var(--color-flexoki-red-400);
  --color-flexoki-dark-or:     var(--color-flexoki-orange-400);
  --color-flexoki-dark-ye:     var(--color-flexoki-yellow-400);
  --color-flexoki-dark-gr:     var(--color-flexoki-green-400);
  --color-flexoki-dark-cy:     var(--color-flexoki-cyan-400);
  --color-flexoki-dark-bl:     var(--color-flexoki-blue-400);
  --color-flexoki-dark-pu:     var(--color-flexoki-purple-400);
  --color-flexoki-dark-ma:     var(--color-flexoki-magenta-400);
  --color-flexoki-light-re-2:  var(--color-flexoki-red-400);
  --color-flexoki-light-or-2:  var(--color-flexoki-orange-400);
  --color-flexoki-light-ye-2:  var(--color-flexoki-yellow-400);
  --color-flexoki-light-gr-2:  var(--color-flexoki-green-400);
  --color-flexoki-light-cy-2:  var(--color-flexoki-cyan-400);
  --color-flexoki-light-bl-2:  var(--color-flexoki-blue-400);
  --color-flexoki-light-pu-2:  var(--color-flexoki-purple-400);
  --color-flexoki-light-ma-2:  var(--color-flexoki-magenta-400);
  --color-flexoki-dark-re-2:   var(--color-flexoki-red-600);
  --color-flexoki-dark-or-2:   var(--color-flexoki-orange-600);
  --color-flexoki-dark-ye-2:   var(--color-flexoki-yellow-600);
  --color-flexoki-dark-gr-2:   var(--color-flexoki-green-600);
  --color-flexoki-dark-cy-2:   var(--color-flexoki-cyan-600);
  --color-flexoki-dark-bl-2:   var(--color-flexoki-blue-600);
  --color-flexoki-dark-pu-2:   var(--color-flexoki-purple-600);
  --color-flexoki-dark-ma-2:   var(--color-flexoki-magenta-600);
}

@layer base {
  :root {
    color-scheme: dark;
  }

  :root[data-theme="light"] {
    color-scheme: light;
    --color-his-bg: var(--color-flexoki-light-bg);
    --color-his-text: var(--color-flexoki-black);
    --color-his-text-secondary: var(--color-flexoki-base-700);
    --color-his-text-tertiary: var(--color-flexoki-base-500);
    --color-his-hr: var(--color-flexoki-light-ui-2);
    --color-his-chat-default: var(--color-flexoki-light-tx-3);
    --color-his-chat-sent: var(--color-flexoki-light-bg-2);
    --color-his-chat-other: var(--color-flexoki-light-bg-2);
    --color-his-hover: var(--color-flexoki-base-100);
    --color-his-active: var(--color-flexoki-base-200); /* Lighter active state for light mode */
    --color-his-green: oklch(0.45 0.12 142.49);
    --color-his-chat-bg: var(--color-flexoki-base-50);
  }

  body {
    @apply scroll-smooth bg-his-bg;
    @apply text-his-text antialiased text-base leading-relaxed font-sans;

    @media (max-width: 768px) {
      @apply text-sm leading-normal;
    }
  }

  a {
    @apply text-his-green;
    
    &:hover {
      @apply transition-colors duration-200;
      color: color-mix(in oklab, var(--color-his-green) 80%, black);
    }
  }

  blockquote {
    @apply my-4 pl-6 border-l-4 border-his-green italic opacity-85;
  }

  h1, h2, h3, h4, h5, h6 {
    @apply mt-4 mb-2;
  }

  h2 {
    @apply text-2xl font-medium;
  }
  h3 {
    @apply text-xl font-medium;
  }
  h4 {
    @apply text-lg uppercase font-bold leading-none tracking-wide my-10;
    scroll-margin-top: 3rem;
  }

  img {
    @apply mb-7 m-0;
  }

  p {
    @apply mb-4;
  }

  ul {
    @apply list-disc list-outside;
  }
  li {
    @apply ml-4;
  }
}

@layer components {
  .toc-link.active {
    @apply bg-his-active text-his-text;
  }

  .message {
    @apply flex flex-col relative max-w-[92%] md:max-w-[85%] lg:max-w-[72%] mb-0 transition-colors duration-300;
    scroll-margin-top: 20px;

    /* Better mobile spacing */
    @media (max-width: 640px) {
      @apply max-w-[96%];
    }

    /* Base message bubble style */
    & .message-bubble {
      @apply px-4 py-3 rounded-2xl bg-his-chat-bg/40 break-words relative mb-1 transition-colors duration-300;

      /* Better mobile touch targets */
      @media (max-width: 640px) {
        @apply px-3 py-2 text-[0.9rem];
      }
    }

    /* Current message highlighting */
    &.message-current .message-bubble {
      @apply bg-his-green/10 border border-his-green/20;
    }

    /* Hide speaker name in consecutive messages */
    &.hide-speaker .message-bubble strong {
      @apply hidden;
    }

    /* Consecutive message styles */
    &.consecutive .message-bubble {
      @apply mb-0 mt-[1px];
    }

    /* First message in a group */
    &.consecutive-start .message-bubble {
      @apply rounded-t-2xl rounded-b-none;
    }

    /* Middle messages in a group */
    &.consecutive:not(.consecutive-start):not(.consecutive-end) .message-bubble {
      @apply rounded-none py-1.5;
    }

    /* Last message in a group */
    &.consecutive-end .message-bubble {
      @apply rounded-b-2xl rounded-t-none mb-3;
    }
  }

  .message-bubble {
    & strong {
      @apply mb-1 font-bold text-his-green;
    }

    /* Better text spacing and readability */
    @apply leading-relaxed;

    /* Enable text selection */
    user-select: text;
    -webkit-user-select: text;
    -moz-user-select: text;
  }

  /* Speaker name styling improvements */
  .message-sent .message-bubble strong {
    @apply text-his-green;
  }

  .message-received .message-bubble strong {
    color: var(--color-flexoki-orange-400);
  }

  .message-system .message-bubble strong {
    color: var(--color-flexoki-cyan-400);
  }

  .message-time {
    @apply text-xs text-gray-100 opacity-0 absolute top-1 right-2 font-mono 
           transition-all duration-200 cursor-pointer select-none z-10
           bg-gray-800/90 px-1.5 py-0.5 rounded;

    &:hover {
      @apply text-his-green;
    }

    /* Hide timestamps on mobile */
    @media (max-width: 768px) {
      @apply hidden;
    }
  }

  .message-bubble:hover .message-time {
    @apply opacity-100;
  }


  /* Right-aligned messages (sent & system) */
  .message-sent, .message-system {
    @apply ml-auto;

    & .message-bubble {
      @apply bg-his-chat-bg/60;
    }
  }

  .message-sent .message-bubble {
    @apply bg-his-chat-sent;
  }

  .message-system .message-bubble {
    @apply bg-his-chat-default;
  }

  /* Left-aligned messages (received) */
  .message-received {
    @apply mr-auto;

    & .message-bubble {
      @apply bg-his-chat-bg/40;
    }
  }

  /* Adjust consecutive message styling */
  .message.consecutive {
    & .message-bubble::before {
      @apply rounded-none;
    }

    &:first-child .message-bubble::before {
      @apply rounded-t-2xl;
    }
  }

  .message.consecutive-end .message-bubble::before {
    @apply rounded-b-2xl;
  }
} 